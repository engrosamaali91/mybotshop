<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Explore the Comprehensive Unitree H1 Documentation for Robotics Enthusiasts,
        Developers, and Researchers. Master Setup, Advanced Control, Integration with
        SLAM Navigation, Odometry, and Real-Time ROS2 Solutions. Unlock the Power of
        Custom Applications and Cutting-Edge Features for Robotics Innovation.</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 0;
            color: #333;
        }
        header, footer {
            text-align: center;
        }
        .container {
            width: 80%;
            margin: auto;
            overflow: hidden;
        }
        .content {
            padding: 20px;
        }
        h1, h2, h3 {
            color: #34A734;
        }
        p {
            text-align: justify;
        }
        code, pre {
            background: #f4f4f4;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
        }
        ul {
            list-style-type: disc;
            margin-left: 20px;
        }
        .highlight {
            background-color: #e8f4fc;
            /* border-left: 4px solid #34A734; */
            padding: 2px;
            margin: 10px 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #ccc;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #34A734;
            color: white;
        }
        tr:nth-child(even) {
            background-color: #f4f4f4;
        }
        .center {
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="main-content">
            <h1>Digital Twin-Driven Safety Protocol Development for HRI in German Retail Stores - Part 2</h1>

            <p1>In Part 1, we explored foundational technologies for developing safety protocols and compliance mechanisms in retail robotics, including simulation environments like Gazebo and NVIDIA Isaac Sim, and key safety standards such as ISO 13482. Building upon that groundwork, Part 2 focuses on testing the practical implementation of these protocols within Gazebo Classic, specifically examining how different combinations of planners and controllers influence robot behavior in various scenarios. This analysis provides actionable insights into achieving safe, efficient navigation in dynamic retail environments.</p1>
            <h2>Understanding Robot Decision-Making: Local and Global Planners</h1>
            <p>Now that we have discussed the need to validate safety protocols and data protection policies—and identified each—it is time to explore what makes a robot autonomous. Specifically, we will dive into <strong>how robots make decisions in different scenarios</strong> and how planners influence these decisions during operation.</p>

            <h3>Local and Global Planners</h3>
            <p>Robots rely on two types of planners to navigate their environments: <strong>local planners</strong> and <strong>global planners</strong>. Each plays a distinct role in ensuring safe, efficient, and autonomous operation.</p>

            <table>
                <thead>
                    <tr>
                        <th>Aspect</th>
                        <th>Local Planner</th>
                        <th>Global Planner</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Scope</td>
                        <td>Handles short-term, real-time navigation and obstacle avoidance.</td>
                        <td>Plans long-term paths from the robot’s start point to its goal.</td>
                    </tr>
                    <tr>
                        <td>Focus</td>
                        <td>Dynamic obstacle handling and maintaining a smooth, collision-free trajectory.</td>
                        <td>Optimizing the overall route based on the map, environment, and defined goals.</td>
                    </tr>
                    <tr>
                        <td>Frequency</td>
                        <td>Operates at a higher frequency (e.g., 10 Hz) for real-time adjustments.</td>
                        <td>Operates at a lower frequency (e.g., 1 Hz) to minimize computational overhead.</td>
                    </tr>
                    <tr>
                        <td>Impact on Safety</td>
                        <td>Ensures immediate responsiveness to nearby obstacles and path deviations.</td>
                        <td>Avoids hazardous routes or areas that could compromise the robot's operation.</td>
                    </tr>
                    <tr>
                        <td>Key Parameters</td>
                        <td>Velocity limits, inflation radius, yaw tolerance for precise control.</td>
                        <td>Map cost layers, goal tolerance for efficient and safe long-term planning.</td>
                    </tr>
                </tbody>
            </table>

            <h3>Nav2 Global Planners and Local Controllers</h3>
            <p>The Nav2 stack provides a robust framework for implementing local and global planners, each tailored to specific use cases and operational environments. The table below categorizes the available planners and controllers:</p>

            <table>
                <thead>
                    <tr>
                        <th>Type</th>
                        <th>Name</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Global Planner</td>
                        <td>NavFn Planner</td>
                        <td>Utilizes Dijkstra's algorithm to compute the shortest path on a costmap.</td>
                    </tr>
                    <tr>
                        <td>Global Planner</td>
                        <td>Smac Planner</td>
                        <td>Offers different variants, including 2D and Hybrid-A* planners, suitable for various robot types and environments.</td>
                    </tr>
                    <tr>
                        <td>Global Planner</td>
                        <td>Theta Planner</td>
                        <td>Computes paths that are more direct by allowing diagonal movements, reducing unnecessary turns.</td>
                    </tr>
                    <tr>
                        <td>Local Controller</td>
                        <td>DWB (Dynamic Window Approach)</td>
                        <td>Evaluates a set of possible trajectories and selects the one that optimally balances progress toward the goal, speed, and obstacle avoidance.</td>
                    </tr>
                    <tr>
                        <td>Local Controller</td>
                        <td>Regulated Pure Pursuit</td>
                        <td>Focuses on following the global path accurately, adjusting the robot's speed based on proximity to obstacles and path curvature.</td>
                    </tr>
                    <tr>
                        <td>Local Controller</td>
                        <td>MPPI (Model Predictive Path Integral)</td>
                        <td>Uses a model predictive control approach to optimize control commands over a future horizon, considering the robot's dynamics and environmental constraints.</td>
                    </tr>
                    <tr>
                        <td>Local Controller</td>
                        <td>Rotation Shim Controller</td>
                        <td>Handles in-place rotation behaviors, ensuring the robot can correctly orient itself before proceeding along the path.</td>
                    </tr>
                </tbody>
            </table>

            <h3>Moving Forward</h3>
            <p>In the following sections, we will explore how these planners influence robot behavior in specific scenarios:</p>
            <ol>
                <li>Going in a Straight Line</li>
                <li>Navigating Around Static Obstacles</li>
                <li>Navigating Around Dynamic Obstacles</li>
            </ol>

            <h3>Relevant Parameters for Navigation Experiments</h3>
            <p>These are the default parameters of the Nav2 stack. In the following experiments, these parameters will be tweaked for different scenarios, planners, and controllers:</p>

            <table>
                <thead>
                    <tr>
                        <th>Parameter Group</th>
                        <th>Parameter Name</th>
                        <th>Value</th>
                        <th>Purpose/Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>AMCL Configuration</td>
                        <td>use_sim_time</td>
                        <td>True</td>
                        <td>Ensures simulation time is used for synchronization.</td>
                    </tr>
                    <tr>
                        <td>Controller Server</td>
                        <td>controller_frequency</td>
                        <td>20.0</td>
                        <td>Frequency at which local controllers compute control commands.</td>
                    </tr>
                    <tr>
                        <td>Costmap Parameters</td>
                        <td>local_costmap.width</td>
                        <td>3.0</td>
                        <td>Defines the width of the local costmap in meters.</td>
                    </tr>
                    <!-- Add more rows as needed -->
                </tbody>
            </table>



            <h4>Combination 1: NavFn Planner + DWB Local Planner</h4>
            <p>This configuration employs the <strong>NavFn Planner</strong> for global path planning and the <strong>DWB Local Planner</strong> for local trajectory adjustments.</p>

            <table>
                <thead>
                    <tr>
                        <th>Component</th>
                        <th>Plugin/Server</th>
                        <th>Type</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Planner Server</td>
                        <td><code>nav2_navfn_planner/NavfnPlanner</code></td>
                        <td>Global Planner</td>
                        <td>Computes the shortest path from start to goal using Dijkstra's algorithm on a costmap.</td>
                    </tr>
                    <tr>
                        <td>Controller Server</td>
                        <td><code>dwb_core::DWBLocalPlanner</code></td>
                        <td>Local Controller</td>
                        <td>Evaluates possible trajectories and selects the one that optimally balances progress, speed, and obstacle avoidance.</td>
                    </tr>
                </tbody>
            </table>

            <h5>Observations and Results</h5>
            <ol>
                <li>
                    <strong>Straight-Line Movement</strong><br>
                    <ul>
                        <li>The robot adhered closely to the planned trajectory with minimal drift.</li>
                        <li>Smooth motion was achieved by tuning parameters such as <code>max_velocity</code> and <code>yaw_goal_tolerance</code>.</li>
                    </ul>
                    <div style="text-align: center;">
                        <img src="https://raw.githubusercontent.com/MYBOTSHOP/media/refs/heads/main/thesis/dw/comb_1/straightline.webp" alt="Straight-Line Movement GIF" style="width:100%; max-width:600px;">

                    </div>
                    <div class="note">
                        <strong>Note:</strong> The scene is speed-forwarded and does not reflect true speed (i.e., 0.26 m/s).
                    </div>
                </li>
                <li>
                    <strong>Static Obstacles</strong><br>
                    <ul>
                        <li>The robot slowed down at the junction and adjusted its speed.</li>
                        <li>Trajectory adjustments were made by the robot, and it remained on the global path.</li>
                        <li>Minor path deviations were corrected by the local controller.</li>
                    </ul>
                    <div style="text-align: center;">
                        <img src="https://raw.githubusercontent.com/MYBOTSHOP/media/refs/heads/main/thesis/dw/comb_1/aroundstatic.webp" alt="Static Obstacles GIF" style="width:100%; max-width:600px;">

                    </div>
                </li>
                <li>
                    <strong>Dynamic Obstacles</strong><br>
                    <ul>
                        <li>The robot successfully responded to a moving cube as a placeholder for a moving person but exhibited slight delays when encountering faster objects.</li>
                        <li>The robot did not collide with the moving cube.</li>
                        <li>The robot did not maintain a safe distance, likely due to suboptimal tuning of parameters such as <code>inflation_radius</code>, <code>PathDist.scale</code>, or <code>obstacle_max_range</code> in the local and global costmaps.</li>
                    </ul>
                    <div style="text-align: center;">
                        <img src="https://raw.githubusercontent.com/MYBOTSHOP/media/refs/heads/main/thesis/dw/comb_1/DynamicObstacles.webp" alt="Dynamic Obstacles GIF" style="width:100%; max-width:600px;">
                    </div>
                </li>
            </ol>

            <h5>Performance Summary</h5>
            <table>
                <thead>
                    <tr>
                        <th>Scenario</th>
                        <th>Performance</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Straight-Line Movement</td>
                        <td>Smooth and precise navigation.</td>
                    </tr>
                    <tr>
                        <td>Static Obstacles</td>
                        <td>Reliable obstacle avoidance with minor deviations.</td>
                    </tr>
                    <tr>
                        <td>Dynamic Obstacles</td>
                        <td>Adequate responsiveness to slow-moving obstacles; improvement needed for fast-moving objects and maintaining safe distance.</td>
                    </tr>
                </tbody>
            </table>

            <h5>Future Considerations</h5>
            <ul>
                <li>The <strong>TEB Local Planner</strong> could be explored for enhanced handling of dynamic obstacles.</li>
                <li>The <strong>Theta* Global Planner</strong> may be utilized for more direct and efficient path generation.</li>
            </ul>

            <h4>Combination 2: NavFn Planner + MPPI Controller</h4>
            <p>This configuration utilizes the <strong>NavFn Planner</strong> for global path planning and the <strong>MPPI (Model Predictive Path Integral) Controller</strong> for local trajectory optimization. This combination is designed to balance efficiency, smoothness, and dynamic obstacle handling.</p>

            <h5>Why MPPI Controller is a Good Choice</h5>
            <p>The <strong>MPPI Controller</strong> is well-suited for dynamic environments requiring real-time adjustments. It optimizes trajectories by considering the robot’s dynamics and environmental constraints, making it highly effective for:</p>
            <ul>
                <li><strong>Dynamic Obstacle Avoidance:</strong> Evaluates multiple trajectories to select the optimal path while avoiding collisions.</li>
                <li><strong>Smooth Path Generation:</strong> Produces jerk-free motions for stable operations.</li>
                <li><strong>Real-Time Performance:</strong> Delivers responsive and efficient control in dynamic scenarios.</li>
            </ul>

            <h5>Relevant Parameters for MPPI Controller</h5>
            <table>
                <thead>
                    <tr>
                        <th>Parameter</th>
                        <th>Value</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>time_horizon</code></td>
                        <td>1.5</td>
                        <td>Time horizon over which the trajectory is optimized.</td>
                    </tr>
                    <tr>
                        <td><code>desired_linear_velocity</code></td>
                        <td>0.5</td>
                        <td>Target velocity for the robot's linear motion.</td>
                    </tr>
                    <tr>
                        <td><code>desired_angular_velocity</code></td>
                        <td>1.0</td>
                        <td>Target velocity for the robot's angular motion.</td>
                    </tr>
                    <tr>
                        <td><code>linear_acceleration_limit</code></td>
                        <td>2.0</td>
                        <td>Maximum allowed linear acceleration for smoother motion.</td>
                    </tr>
                    <tr>
                        <td><code>angular_acceleration_limit</code></td>
                        <td>3.0</td>
                        <td>Maximum allowed angular acceleration for smoother turns.</td>
                    </tr>
                    <tr>
                        <td><code>optimizer_iterations</code></td>
                        <td>1000</td>
                        <td>Number of iterations for trajectory optimization in each cycle.</td>
                    </tr>
                    <tr>
                        <td><code>cost_weights.path_following</code></td>
                        <td>10.0</td>
                        <td>Weight for staying close to the planned path.</td>
                    </tr>
                    <tr>
                        <td><code>cost_weights.collision_avoidance</code></td>
                        <td>15.0</td>
                        <td>Weight for avoiding collisions with obstacles.</td>
                    </tr>
                    <tr>
                        <td><code>cost_weights.smoothness</code></td>
                        <td>5.0</td>
                        <td>Weight for ensuring smooth trajectories.</td>
                    </tr>
                    <tr>
                        <td><code>lookahead_dist</code></td>
                        <td>0.6</td>
                        <td>Distance ahead of the robot for trajectory optimization.</td>
                    </tr>
                    <tr>
                        <td><code>transform_tolerance</code></td>
                        <td>0.1</td>
                        <td>Tolerance for transform lookups to ensure stability in real-time adjustments.</td>
                    </tr>
                    <tr>
                        <td><code>visualize_optimizer</code></td>
                        <td>true</td>
                        <td>Enables visualization of the optimized trajectories for debugging in RViz.</td>
                    </tr>
                </tbody>
            </table>

            <h5>Testing Scenarios and Observations</h5>
            <ol>
                <li>
                    <strong>Straight-Line Movement</strong><br>
                    <ul>
                        <li>The robot followed a smooth and precise trajectory with minimal drift.</li>
                        <li>Real-time trajectory optimization ensured stable motion.</li>
                    </ul>
                    <div style="text-align: center;">
                        <img src="https://raw.githubusercontent.com/MYBOTSHOP/media/refs/heads/main/thesis/dw/comb_2/straightline.webp" alt="Straight-Line Movement GIF" style="width:100%; max-width:600px;">
                    </div>
                </li>
                <li>
                    <strong>Navigating Static Obstacles</strong><br>
                    <ul>
                        <li>The controller successfully adjusted the robot's path to avoid obstacles, maintaining smooth transitions.</li>
                        <li>Dynamic trajectory optimization minimized unnecessary deviations.</li>
                    </ul>
                    <div style="text-align: center;">
                        <img src="https://raw.githubusercontent.com/MYBOTSHOP/media/refs/heads/main/thesis/dw/comb_2/static.webp" alt="Static Obstacles GIF" style="width:100%; max-width:600px;">
                    </div>
                </li>
                <li>
                    <strong>Navigating Dynamic Obstacles</strong><br>
                    <ul>
                        <li>The robot responded effectively to moving obstacles, recalculating the trajectory in real time.</li>
                        <li>The robot maintained a safe distance from the moving object.</li>
                        <li>Optimized control commands reduced delays in avoiding faster-moving objects.</li>
                    </ul>
                    <div style="text-align: center;">
                        <img src="https://raw.githubusercontent.com/MYBOTSHOP/media/refs/heads/main/thesis/dw/comb_2/dynamic.webp" alt="Dynamic Obstacles GIF" style="width:100%; max-width:600px;">
                    </div>
                </li>
            </ol>

            <h5>Performance Summary</h5>
            <table>
                <thead>
                    <tr>
                        <th>Scenario</th>
                        <th>Performance</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Straight-Line Movement</td>
                        <td>Smooth and precise navigation.</td>
                    </tr>
                    <tr>
                        <td>Static Obstacles</td>
                        <td>Reliable obstacle avoidance with smooth trajectory adjustments.</td>
                    </tr>
                    <tr>
                        <td>Dynamic Obstacles</td>
                        <td>Effective real-time responses to moving obstacles.</td>
                    </tr>
                </tbody>
            </table>

            <h5>Conclusion</h5>
            <p>The combination of <strong>NavFn Planner</strong> and <strong>MPPI Controller</strong> provided robust performance across all scenarios. Its ability to handle dynamic obstacles and generate smooth trajectories makes it an excellent choice for complex environments.</p>

            <h6>Future Improvements</h6>
            <ul>
                <li>Further tuning of <strong>cost weights</strong> and <strong>time horizon</strong> could enhance responsiveness in highly dynamic settings.</li>
                <li>Exploring alternate global planners, such as <strong>Smac (Hybrid-A*)</strong>, may yield better path efficiency for intricate environments.</li>
            </ul>



            <h4>Combination 3: NavFn Planner + Regulated Pure Pursuit Controller</h4>
            <p>This configuration utilizes the <strong>NavFn Planner</strong> for global path planning and the <strong>Regulated Pure Pursuit Controller</strong> for local trajectory adjustments. While this combination is highly efficient for straight-line movements, its performance diminishes when navigating through close proximities or dynamic environments.</p>
        
            <h5>Why Regulated Pure Pursuit Controller is a Good Choice</h5>
            <p>The <strong>Regulated Pure Pursuit Controller</strong> is known for its simplicity and reliability in following global paths, particularly in open environments. It is designed to scale its velocity based on proximity to obstacles and path curvature, ensuring smooth and precise motion.</p>
            <ul>
                <li><strong>Ideal for Straight-Line Movements:</strong> Ensures smooth and predictable navigation without significant path deviations.</li>
                <li><strong>Velocity Regulation:</strong> Dynamically adjusts speed to maintain safety when approaching obstacles.</li>
                <li><strong>Ease of Tuning:</strong> Fewer parameters compared to more complex controllers, simplifying configuration.</li>
            </ul>
        
            <h5>Relevant Parameters for Regulated Pure Pursuit Controller</h5>
            <table>
                <thead>
                    <tr>
                        <th>Parameter</th>
                        <th>Value</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>desired_linear_vel</code></td>
                        <td>0.5</td>
                        <td>Target velocity for the robot's linear motion.</td>
                    </tr>
                    <tr>
                        <td><code>lookahead_dist</code></td>
                        <td>0.6</td>
                        <td>Distance ahead of the robot for trajectory adjustments.</td>
                    </tr>
                    <tr>
                        <td><code>min_lookahead_dist</code></td>
                        <td>0.3</td>
                        <td>Minimum distance for trajectory adjustments.</td>
                    </tr>
                    <tr>
                        <td><code>max_lookahead_dist</code></td>
                        <td>0.9</td>
                        <td>Maximum distance for trajectory adjustments.</td>
                    </tr>
                    <tr>
                        <td><code>rotate_to_heading_angular_vel</code></td>
                        <td>1.8</td>
                        <td>Angular velocity for orienting toward the path heading.</td>
                    </tr>
                    <tr>
                        <td><code>use_velocity_scaled_lookahead_dist</code></td>
                        <td>false</td>
                        <td>Disables scaling of lookahead distance based on velocity.</td>
                    </tr>
                    <tr>
                        <td><code>use_collision_detection</code></td>
                        <td>true</td>
                        <td>Enables obstacle detection for safer navigation.</td>
                    </tr>
                    <tr>
                        <td><code>max_allowed_time_to_collision_up_to_carrot</code></td>
                        <td>1.0</td>
                        <td>Maximum allowed time to potential collisions along the path.</td>
                    </tr>
                    <tr>
                        <td><code>min_approach_linear_velocity</code></td>
                        <td>0.05</td>
                        <td>Minimum velocity when approaching a goal or obstacle.</td>
                    </tr>
                    <tr>
                        <td><code>transform_tolerance</code></td>
                        <td>0.1</td>
                        <td>Tolerance for transform lookups to ensure stability in real-time adjustments.</td>
                    </tr>
                </tbody>
            </table>
        
            <h5>Testing Scenarios and Observations</h5>
            <ol>
                <li>
                    <strong>Straight-Line Movement</strong><br>
                    <ul>
                        <li>The robot navigated smoothly and efficiently, adhering to the global path without significant deviations.</li>
                        <li>Velocity regulation ensured stable and precise motion.</li>
                    </ul>
                    <div style="text-align: center;">
                        <img src="https://raw.githubusercontent.com/MYBOTSHOP/media/refs/heads/main/thesis/dw/comb_3/straight.webp" alt="Straight-Line Movement GIF" style="width:100%; max-width:600px;">
                    </div>
                </li>
                <li>
                    <strong>Navigating Static Obstacles</strong><br>
                    <ul>
                        <li>Performance was suboptimal, particularly when passing through close gaps.</li>
                        <li>The robot struggled with efficiency compared to other combinations like NavFn + DWB and NavFn + MPPI.</li>
                    </ul>
                    <div style="text-align: center;">
                        <img src="https://raw.githubusercontent.com/MYBOTSHOP/media/refs/heads/main/thesis/dw/comb_3/static2.webp" alt="Static Obstacles GIF" style="width:100%; max-width:600px;">
                    </div>
                </li>
                <li>
                    <strong>Navigating Dynamic Obstacles</strong><br>
                    <ul>
                        <li>The robot managed to replan and avoid moving obstacles, but the response time was slower than other controllers.</li>
                        <li>While it successfully reached the goal pose, the delay in path adjustments indicated limited efficiency in dynamic scenarios.</li>
                    </ul>
                    <div style="text-align: center;">
                        <img src="https://raw.githubusercontent.com/MYBOTSHOP/media/refs/heads/main/thesis/dw/comb_3/Dynamic.webp" alt="Dynamic Obstacles GIF" style="width:100%; max-width:600px;">
                    </div>
                </li>
            </ol>
        
            <h5>Performance Summary</h5>
            <table>
                <thead>
                    <tr>
                        <th>Scenario</th>
                        <th>Performance</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Straight-Line Movement</td>
                        <td>Smooth and precise navigation, ideal for open spaces.</td>
                    </tr>
                    <tr>
                        <td>Static Obstacles</td>
                        <td>Struggled with close proximities, less efficient compared to other combinations.</td>
                    </tr>
                    <tr>
                        <td>Dynamic Obstacles</td>
                        <td>Slow in replanning and path adjustments, though able to reach the goal.</td>
                    </tr>
                </tbody>
            </table>
        
            <h5>Conclusion</h5>
            <p>The combination of <strong>NavFn Planner</strong> and <strong>Regulated Pure Pursuit Controller</strong> is well-suited for open environments with minimal obstacles. However, its limitations become evident in more complex scenarios, such as navigating through tight spaces or reacting to dynamic obstacles.</p>
        
            <h6>Future Improvements</h6>
            <ul>
                <li>Consider using <strong>DWB</strong> or <strong>MPPI</strong> for environments with close proximities or high dynamic activity.</li>
                <li>Fine-tune parameters like <code>lookahead_dist</code> and enable <strong>velocity-scaled lookahead</strong> for more responsive adjustments.</li>
            </ul>
        
            <h5>Interconnected Nodes in Nav2 Stack</h5>
            <p>To better understand the communication between various components of the Nav2 stack, here’s the <strong>RQT Graph</strong> visualization of interconnected nodes. This includes key nodes like the <strong>local cost map</strong>, <strong>global cost map</strong>, <strong>controller server</strong>, <strong>planner server</strong>, and <strong>behavior server</strong>.</p>
            <div style="text-align: center;">
                <img src="https://raw.githubusercontent.com/MYBOTSHOP/media/refs/heads/main/thesis/dw/comb_3/rosgraph.webp" alt="RQT Graph Visualization" style="width:100%; max-width:600px;">

            </div>
        
            <div class="note">
                <strong>Note:</strong> The RQT graph illustrates how these components interact to ensure smooth and efficient navigation. Each node plays a critical role:
                <ul>
                    <li><strong>Planner Server:</strong> Computes the global path.</li>
                    <li><strong>Controller Server:</strong> Adjusts the local trajectory for real-time obstacle avoidance.</li>
                    <li><strong>Behavior Server:</strong> Manages higher-level behaviors like spinning, backing up, and driving on heading.</li>
                    <li><strong>Cost Maps:</strong> Provide the environmental representation for planning and obstacle avoidance.</li>
                </ul>
                This interconnected structure ensures seamless communication and dynamic adaptability during navigation.

            </div>

            <h4>Combination 4: Theta* + Regulated Pure Pursuit Controller</h4>

            <h5>How Theta* Differs from Navfn Planner</h5>
            <p>The <strong>Theta*</strong> planner generates any-angle paths with smoother, more direct line segments, while <strong>Navfn</strong> is constrained to grid-based paths, resulting in more angular and less efficient routes.</p>

            <h5>Theta* + RPP: Observations and Insights</h5>

            <h6>Straight-Line Movement</h6>
            <p>In a straightforward scenario, the robot moved along a straight line as expected when the path was unobstructed. This behavior highlights the efficiency of the Theta* planner in generating direct, any-angle paths, reducing unnecessary turns, and optimizing the travel distance.</p>
            <div style="text-align: center;">
                <img src="https://raw.githubusercontent.com/MYBOTSHOP/media/refs/heads/main/thesis/dw/comb_4/straight.webp" alt="Straight-Line Movement" style="width:100%; max-width:600px;">
            </div>

            <h6>Static Environment</h6>
            <p>When multiple waypoints were provided, the robot recalculated the path dynamically instead of strictly following the given waypoints. It took a shortcut, reaching the goal faster than if it had adhered to the exact waypoints.</p>
            <p><strong>Reason:</strong> The Theta* planner is designed to optimize for the shortest and most efficient path between the start and goal. Waypoints, unless enforced as strict constraints, are treated as optional guides. The recalculated shortcut reflects the planner’s inherent focus on path optimization and reduced traversal time.</p>
            <div style="text-align: center;">
                <img src="https://raw.githubusercontent.com/MYBOTSHOP/media/refs/heads/main/thesis/dw/comb_4/static.webp" alt="Static Environment Shortcut" style="width:100%; max-width:600px;">
            </div>

            <h6>Dynamic Environment</h6>
            <p>In a dynamic setup, a walking person primitive was introduced as a moving obstacle:</p>
            <ul>
                <li><strong>First Trial:</strong> The robot collided with the moving person, likely due to limitations in the <strong>RPP local planner</strong> as observed in conjunction with the Navfn planner, which did not react quickly enough to the dynamic change.</li>
                <li><strong>Second Trial:</strong> After the person moved aside, the robot successfully stopped, recalculated a shorter path, and reached the goal.</li>
            </ul>
            <div style="text-align: center;">
                <img src="https://raw.githubusercontent.com/MYBOTSHOP/media/refs/heads/main/thesis/dw/comb_4/dynamic.webp" alt="Dynamic Successful Trial 2" style="width:100%; max-width:600px;">
            </div>
            <p><strong>Reason:</strong> This outcome underscores the adaptability of Theta* + RPP (Reactive Path Planning). The planner dynamically recalculated the path based on real-time updates, showcasing its ability to handle dynamic obstacles effectively. The successful adjustment in the second trial highlights the importance of robust integration between the global and local planning layers.</p>

            <h5>Performance Summary</h5>
            <table>
                <thead>
                    <tr>
                        <th>Feature</th>
                        <th>Performance</th>
                        <th>Comments</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Straight-Line Movement</td>
                        <td>Smooth and efficient direct paths.</td>
                        <td>Theta* generates optimal, any-angle paths, making it ideal for open and unconstrained environments.</td>
                    </tr>
                    <tr>
                        <td>Static Obstacles</td>
                        <td>Dynamically recalculates efficient paths.</td>
                        <td>Bypasses unnecessary waypoints to optimize travel time and distance in static environments.</td>
                    </tr>
                    <tr>
                        <td>Dynamic Obstacles</td>
                        <td>Relies on the local planner for handling dynamic changes effectively.</td>
                        <td>RPP’s responsiveness impacts success; improvements in local planner integration could enhance reliability.</td>
                    </tr>
                </tbody>
            </table>

            <p>These observations illustrate the strengths of Theta* + RPP in both static and dynamic scenarios. While the planner excels at optimizing paths, ensuring a robust local planner is critical for managing dynamic obstacles in real-world environments.</p>




            <h4>Combination 5: Smac Planner + MPPI</h4>

            <h5>Navigation Performance: Testing Smac Planner + MPPI Controller</h5>
            <p>The combination of the <strong>Smac Planner</strong> and <strong>MPPI Controller</strong> represents an advanced setup designed to handle complex navigation scenarios. While the Smac Planner excels at generating smooth, kinematic-aware paths, the MPPI Controller provides real-time trajectory optimization and dynamic obstacle handling.</p>
        
            <h5>Testing Scenarios and Observations</h5>
            <ol>
                <li>
                    <strong>Straight-Line Movement</strong><br>
                    <ul>
                        <li>The robot performed satisfactorily, following a smooth and direct path.</li>
                        <li>No significant deviations or delays were observed.</li>
                    </ul>
                    <div style="text-align: center;">
                        <img src="https://raw.githubusercontent.com/MYBOTSHOP/media/refs/heads/main/thesis/dw/comb_5/Straight.webp" alt="Straight-Line Movement GIF" style="width:100%; max-width:600px;">
                    </div>
                </li>
                <li>
                    <strong>Navigating Static Obstacles</strong><br>
                    <ul>
                        <li>The Smac Planner generated a longer path to avoid obstacles.</li>
                        <li>As the robot approached the goal, it took additional time to stabilize.</li>
                        <li>The robot struggled slightly when passing through narrow gaps between walls, experiencing delays due to repeated replanning.</li>
                    </ul>
                    <div style="text-align: center;">
                        <img src="https://raw.githubusercontent.com/MYBOTSHOP/media/refs/heads/main/thesis/dw/comb_5/Static.webp" alt="Static Obstacles GIF" style="width:100%; max-width:600px;">
                    </div>
                </li>
                <li>
                    <strong>Navigating Dynamic Obstacles</strong><br>
                    <ul>
                        <li>The robot detected a moving wheelchair but was less robust in avoiding it compared to the NavFn + MPPI combination.</li>
                        <li>Multiple replanning attempts were necessary to successfully navigate around the obstacle.</li>
                        <li>Despite these challenges, the robot ultimately reached the goal.</li>
                    </ul>
                    <div style="text-align: center;">
                        <img src="https://raw.githubusercontent.com/MYBOTSHOP/media/refs/heads/main/thesis/dw/comb_5/Dynamic.webp" alt="Dynamic Obstacles GIF" style="width:100%; max-width:600px;">
                    </div>
                </li>
            </ol>
        
            <h5>Performance Summary</h5>
            <table>
                <thead>
                    <tr>
                        <th>Scenario</th>
                        <th>Performance</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Straight-Line Movement</td>
                        <td>Smooth and efficient navigation.</td>
                    </tr>
                    <tr>
                        <td>Static Obstacles</td>
                        <td>Planned longer paths; delays in narrow gaps and stabilizing near the goal.</td>
                    </tr>
                    <tr>
                        <td>Dynamic Obstacles</td>
                        <td>Detected moving objects but struggled with robustness; required multiple replans.</td>
                    </tr>
                </tbody>
            </table>
        
            <h5>Conclusion</h5>
            <p>The combination of <strong>Smac Planner</strong> and <strong>MPPI Controller</strong> demonstrates strong potential for complex environments, particularly in scenarios requiring kinematic awareness and smooth trajectory optimization. However, challenges remain:</p>
            <ul>
                <li><strong>Static Obstacles:</strong> Path planning and stabilization need improvement for close proximities.</li>
                <li><strong>Dynamic Obstacles:</strong> Responsiveness to fast-moving objects requires further tuning.</li>
            </ul>
        
            <h6>Future Improvements</h6>
            <ul>
                <li>Optimize Smac Planner parameters for shorter paths and quicker stabilization.</li>
                <li>Fine-tune MPPI cost weights for better responsiveness to dynamic obstacles.</li>
            </ul>



            <h3>Navigation Performance and Suitability for Safety Scenarios</h3>
            <table>
                <thead>
                    <tr>
                        <th>Global Planner + Local Controller</th>
                        <th>Straight-Line Movement</th>
                        <th>Static Obstacles</th>
                        <th>Dynamic Obstacles</th>
                        <th>Obstacle Clearance</th>
                        <th>Dynamic Obstacle Handling</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>NavFn + DWB</td>
                        <td style="text-align: center;">✅</td>
                        <td style="text-align: center;">✅</td>
                        <td style="text-align: center;">❌</td>
                        <td style="text-align: center;">Good</td>
                        <td style="text-align: center;">Moderate responsiveness</td>
                    </tr>
                    <tr>
                        <td>NavFn + MPPI</td>
                        <td style="text-align: center;">✅</td>
                        <td style="text-align: center;">✅</td>
                        <td style="text-align: center;">✅</td>
                        <td style="text-align: center;">Excellent</td>
                        <td style="text-align: center;">Highly responsive</td>
                    </tr>
                    <tr>
                        <td>NavFn + RPP</td>
                        <td style="text-align: center;">✅</td>
                        <td style="text-align: center;">❌</td>
                        <td style="text-align: center;">❌</td>
                        <td style="text-align: center;">Average (struggles in gaps)</td>
                        <td style="text-align: center;">Slow</td>
                    </tr>
                    <tr>
                        <td>Theta* + RPP</td>
                        <td style="text-align: center;">✅</td>
                        <td style="text-align: center;">✅</td>
                        <td style="text-align: center;">❌</td>
                        <td style="text-align: center;">Excellent</td>
                        <td style="text-align: center;">Slow</td>
                    </tr>
                    <tr>
                        <td>Smac Planner Hybrid + MPPI</td>
                        <td style="text-align: center;">✅</td>
                        <td style="text-align: center;">✅</td>
                        <td style="text-align: center;">❌</td>
                        <td style="text-align: center;">Bad</td>
                        <td style="text-align: center;">Moderate responsiveness</td>
                    </tr>
                </tbody>
            </table>
        
            <div class="note">
                <strong>Key:</strong>
                <ul>
                    <li><strong>✅:</strong> Suitable</li>
                    <li><strong>❌:</strong> Not Suitable</li>
                    <li><strong>Obstacle Clearance:</strong> Describes the ability to navigate close proximities without collisions (e.g., Excellent, Good, Bad).</li>
                    <li><strong>Dynamic Obstacle Handling:</strong> Describes the responsiveness to moving obstacles (e.g., Highly responsive, Moderate, Slow).</li>
                </ul>
            </div>
        
            <div class="important">
                <strong>Important:</strong>
                <p>Controllers perform differently based on drive types (e.g., differential, Ackermann), impacting navigation results. Proper pairing and tuning are crucial for optimal performance.</p>
            </div>
        
            <div class="note">
                <strong>Note:</strong>
                <p>Different drives may give varying results.</p>
            </div>
        
            <h3>Planner Suitability for Different Robot Types</h3>
            <table>
                <thead>
                    <tr>
                        <th>Planner Name</th>
                        <th>Circular Differential</th>
                        <th>Circular Omnidirectional</th>
                        <th>Non-Circular Ackermann</th>
                        <th>Non-Circular Legged</th>
                        <th>Non-Circular Differential/Omnidirectional</th>
                        <th>Arbitrary</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>NavFn Planner</td>
                        <td style="text-align: center;">✅</td>
                        <td style="text-align: center;">✅</td>
                        <td style="text-align: center;">❌</td>
                        <td style="text-align: center;">❌</td>
                        <td style="text-align: center;">❌</td>
                        <td style="text-align: center;">❌</td>
                    </tr>
                    <tr>
                        <td>Smac Planner 2D</td>
                        <td style="text-align: center;">✅</td>
                        <td style="text-align: center;">✅</td>
                        <td style="text-align: center;">❌</td>
                        <td style="text-align: center;">❌</td>
                        <td style="text-align: center;">❌</td>
                        <td style="text-align: center;">❌</td>
                    </tr>
                    <tr>
                        <td>Theta* Planner</td>
                        <td style="text-align: center;">✅</td>
                        <td style="text-align: center;">✅</td>
                        <td style="text-align: center;">❌</td>
                        <td style="text-align: center;">❌</td>
                        <td style="text-align: center;">❌</td>
                        <td style="text-align: center;">❌</td>
                    </tr>
                    <tr>
                        <td>Smac Hybrid-A* Planner</td>
                        <td style="text-align: center;">✅</td>
                        <td style="text-align: center;">✅</td>
                        <td style="text-align: center;">✅</td>
                        <td style="text-align: center;">✅</td>
                        <td style="text-align: center;">✅</td>
                        <td style="text-align: center;">❌</td>
                    </tr>
                    <tr>
                        <td>Smac Lattice Planner</td>
                        <td style="text-align: center;">❌</td>
                        <td style="text-align: center;">❌</td>
                        <td style="text-align: center;">✅</td>
                        <td style="text-align: center;">✅</td>
                        <td style="text-align: center;">✅</td>
                        <td style="text-align: center;">✅</td>
                    </tr>
                </tbody>
            </table>
        
            <div class="note">
                <strong>Key:</strong>
                <ul>
                    <li><strong>✅:</strong> Suitable for this type of robot.</li>
                    <li><strong>❌:</strong> Not suitable for this type of robot.</li>
                </ul>
            </div>
        
            <h3>Controller Suitability for Different Robot Types and Tasks</h3>
            <table>
                <thead>
                    <tr>
                        <th>Controller Name</th>
                        <th>Differential</th>
                        <th>Omnidirectional</th>
                        <th>Ackermann</th>
                        <th>Legged</th>
                        <th>Primary Task</th>
                    </tr>
                </thead>
                <tbody>
                    <tr >
                        <td>DWB Controller</td>
                        <td style="text-align: center;">✅</td>
                        <td style="text-align: center;">✅</td>
                        <td style="text-align: center;">❌</td>
                        <td style="text-align: center;">❌</td>
                        <td style="text-align: center;">Dynamic obstacle avoidance</td>
                    </tr>
                    <tr>
                        <td>MPPI Controller</td>
                        <td style="text-align: center;">✅</td>
                        <td style="text-align: center;">✅</td>
                        <td style="text-align: center;">✅</td>
                        <td style="text-align: center;">✅</td>
                        <td style="text-align: center;">Dynamic obstacle avoidance</td>
                    </tr>
                    <tr>
                        <td>RPP Controller</td>
                        <td style="text-align: center;">✅</td>
                        <td style="text-align: center;">❌</td>
                        <td style="text-align: center;">✅</td>
                        <td style="text-align: center;">✅</td>
                        <td style="text-align: center;">Exact path following</td>
                    </tr>
                    <tr>
                        <td>Rotation Shim</td>
                        <td style="text-align: center;">✅</td>
                        <td style="text-align: center;">✅</td>
                        <td style="text-align: center;">❌</td>
                        <td style="text-align: center;">❌</td>
                        <td style="text-align: center;">Rotate to rough heading</td>
                    </tr>
                    <tr>
                        <td>VP Controller</td>
                        <td style="text-align: center;">✅</td>
                        <td style="text-align: center;">❌</td>
                        <td style="text-align: center;">✅</td>
                        <td style="text-align: center;">✅</td>
                        <td style="text-align: center;">High-speed path tracking</td>
                    </tr>
                </tbody>
            </table>
        
            <div class="note">
                <strong>Key:</strong>
                <ul>
                    <li><strong>✅:</strong> Suitable for this type of robot.</li>
                    <li><strong>❌:</strong> Not suitable for this type of robot.</li>
                </ul>
             </div>

            
             <h2> Conclusion</h2>
            Selecting appropriate planners and controllers is critical for robotic navigation as they must align with the specific task and operational environment. The efficiency of these components varies across different scenarios, such as static and dynamic obstacle navigation, where factors like computational demand, safety, and precision play vital roles. Moreover, tuning parameters in the navigation stack is essential to optimize performance and adaptability. It is, therefore, crucial to comply with safety protocols, especially in environments like retail stores, to ensure safe and efficient human-robot interactions while adhering to regulatory standards and minimizing potential risks.
    </div>
</body>
</html>

